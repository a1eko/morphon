#!/usr/bin/env python

"Neuron morphology viewer"

from morphon import Morpho, plot
import argparse

import matplotlib as mpl
from mpl_toolkits.mplot3d import Axes3D
import matplotlib.pyplot as plt


def parse():
    parser = argparse.ArgumentParser(description=__doc__)
    parser.add_argument("file", type=str, help="input file (swc)", nargs='+')
    return parser.parse_args()


def main():
    args = parse()
    fig = plt.figure()
    ax = fig.gca(projection='3d')
    if len(args.file) == 1:
        ax.set_title(args.file[0])
	equal_scales=True
    else:
	equal_scales=False
    ax.set_xlabel('x')
    ax.set_ylabel('z')
    ax.set_zlabel('y')
    colors = {'soma': 'black', 'dend': 'blue', 'apic': 'green', 'axon': 'red'}
    thickness = {'soma': 5, 'dend': 1, 'apic': 1, 'axon': 0.5}
    for morphology in args.file:
        m = Morpho(morphology)
        neurites = set(m.neurite(i) for i in m.traverse())
        for neurite in neurites:
            plot(m, ax, projection='3d', 
                neurites=[neurite],
                color=colors[neurite],
                linewidth=thickness[neurite],
                equal_scales=equal_scales)
    plt.show()


if __name__ == "__main__":
    main()
